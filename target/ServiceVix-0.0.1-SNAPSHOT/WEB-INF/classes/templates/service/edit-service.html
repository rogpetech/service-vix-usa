<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/dataTables.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/slimselect.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-icons.min.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-select.min.css}">
	<link rel="stylesheet" th:href="@{/css/style.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.css}">
	<link rel="stylesheet" th:href="@{/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css}">
</head>

<body>
	<!--navbar-->

	<div class="body_container d-flex">
		<div th:replace="component/sidebar :: sidebar"></div>
		<div class="main">
			<!-- haeder -->
			<header th:replace="component/topmenu :: topmenu"></header>
			<!-- headerend -->
			<!-- mainconatiner -->
			<div class="container-fluid p-2 p-md-3 p-lg-4 scroll-conatiner">
				<div class="row h-100">
					<div class="col-12">
						<div class="card data-cards h-100">
							<div class="add-satff-container p-2">
								<div class="data-cards-header">
									<h4>Edit Service</h4>
								</div>
								<div class="data-cards-body mt-4">


									<form th:action="@{/service/process-update}" method="post"
										enctype="multipart/form-data" class="row g-4" id="form_service" onsubmit="formatPrices()">
										<p class="section-heading">Service Information</p>
										<input type="hidden" name="id" th:value="${serviceDto.id}">
										<div class="col-md-6">
											<div class="input_field">
												<label for="inp_service_name" class="form-label">Service
													Name</label> <input type="text" class="form-control"
													id="inp_service_name" name="serviceName"
													th:value="${serviceDto.serviceName}"> <i
													class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6">
											<label for="select_service_category" class="form-label">Service
												Category</label> <select class="selectpicker form-control"
												id="select_service_category" name="serviceCategoryId"
												th:value="${serviceDto.serviceCategoryId}">
												<option selected="selected">Select one</option>
												<option th:each="serviceCat : ${serviceCategories}"
													th:value="${serviceCat.serviceCategoryId}"
													th:selected="${serviceDto.serviceCategoryId == serviceCat.serviceCategoryId}">
													<span th:text="${serviceCat.serviceCategoryName}"></span>
												</option>
												<!-- <option value="1">Service 1</option>
                                                            <option value="1">Service 2</option>
                                                            <option value="1">Service 3</option>
                                                            <option value="1">Service 4</option> -->

											</select>
										</div>
										<div class="col-md-6">
											<label for="inp_ser_dec" class="form-label">Description</label>
											<textarea class="form-control custom-area" id="inp_ser_dec" rows="3"
												name="discription" th:text="${serviceDto.discription}"></textarea>
										</div>
										<div class="col-md-6 position-relative">
											<label class="form-label">Service Images</label>
											<div class="upload__box">
												<div class="upload__img-wrap"></div>
												<div class="upload__btn-box">
													<label for="upload_service_pics"
														class="upload__btn primary-btn">Upload images <input type="file"
															multiple="" data-max_length="20" class="upload__inputfile"
															id="upload_service_pics" name="categoryImage"
															accept="image/*" th:value="${serviceDto.serviceImage}">
													</label>
												</div>
											</div>
										</div>

										<p class="mt-5 section-heading">Service Rates</p>

										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="reg_rate" class="form-label">Regular
													Rate($)</label> <input type="text" class="form-control"
													id="reg_rate" name="regularPrice"
													th:value= "'$'+${#numbers.formatDecimal(serviceDto.regularPrice, 0, 'COMMA', 2, 'POINT')}"
													step="0.01"
													oninput="updateHiddenField(this, 'reg_rate')"> <i
													class="fas fa-check-circle"></i>
												<i class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="mem_rate" class="form-label">Member
													Rate($)</label> <input type="text" class="form-control"
													id="mem_rate" name="internalCost"
													th:value="'$'+${#numbers.formatDecimal(serviceDto.internalCost, 0, 'COMMA', 2, 'POINT')}" step="0.01"
													oninput="updateHiddenField(this, 'mem_rate')"> <i
													class="fas fa-check-circle"></i>
												<i class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>

										<div class="col-12">
											<div class="form-submit">
												<a th:href="@{/product/products}" class="secondary-btn form-btns me-3"
													id="mainPageCancel">Cancel</a>
												<button type="submit" class="primary-btn form-btns">Add
													Service</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/js/jquery.min.js}"></script>
	<script th:src="@{/js/bootstrap-select.min.js}"></script>
	<script th:src="@{/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/js/dataTables.responsive.min.js}"></script>
	<script th:src="@{/js/responsive.bootstrap5.min.js}"></script>
	<script th:src="@{/js/dataTables.bootstrap5.min.js}"></script>
	<script th:src="@{/js/slimselect.js}"></script>
	<script th:src="@{/https://cdn.jsdelivr.net/npm/apexcharts@latest}"></script>
	<script th:src="@{/js/main.js}"></script>
	<script th:src="@{/js/form_validations.js}"></script>
	<script>
		function updateHiddenField(input, hiddenFieldId) {
			let value = input.value.replace(/[^0-9.]/g, '');
			document.getElementById(hiddenFieldId).value = value;
			value = input.value.replace(/[^0-9.]/g, '');
			value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			value = "$" + value;
			input.value = value;
		}

	</script>
	<script>
		function formatPrices() {
			let avgCostStr = document.getElementById("mem_rate");
			let mem_privceStr = document.getElementById("reg_rate");
			avgCostStr.value = avgCostStr.value.replace(/[$,]/g, '');
			mem_privceStr.value = mem_privceStr.value.replace(/[$,]/g, '');
			alert(originalPriceStr);
			return false;
		}
	</script>
</body>

</html>