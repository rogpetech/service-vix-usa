<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ServiceVix | Add/View Estimate</title>
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/dataTables.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/slimselect.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-icons.min.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-select.min.css}">
	<link rel="stylesheet" th:href="@{/css/style.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.css}">
	<link rel="stylesheet" th:href="@{/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css}">
	<style>
		#container {
			padding: 15px;
			/* border: 3px solid #000*/
		}

		#container table {
			border-collapse: collapse;
		}

		/* #container th {resize:horizontal;overflow:auto} */
		#container th,
		#container td {
			/* border: 1px solid black;*/
			padding: 8px
		}
	</style>

</head>

<body>

	<!--navbar-->

	<div class="body_container d-flex">
		<div th:replace="component/sidebar :: sidebar"></div>
		<div class="main">
			<!-- haeder -->
			<header th:replace="component/topmenu :: topmenu"></header>
			<!-- headerend -->
			<!-- mainconatiner -->
			<!--Remove Page Validation Modal -->
			<div class="modal fade" id="leaveModal" tabindex="-1" role="dialog" aria-labelledby="leaveModalLabel"
				aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="leaveModalLabel">Warning</h5>
						</div>
						<div class="modal-body">
							Are you sure you want to leave this page? You will lose your unsaved data.
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
							<button type="button" class="btn btn-primary" id="leaveButton">Leave</button>
						</div>
					</div>
				</div>
			</div>
			<!-- Remove Page Validation Modal End -->
			<div id="add-job-parent-div" class="container-fluid  p-2 p-md-3 p-lg-4 scroll-conatiner">
				<!-- add_customer_modal-->
				<div class="modal fade" id="addCustomerModal" tabindex="-1" aria-labelledby="addCustomerLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered modal-lg">
						<div class="modal-content update-profile-modal">
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							<div class="modal-body">
								<div class="est-header d-flex">
									<h5 class="fw-bold">Add Customer</h5>
								</div>
								<div class="send-estimate-container mt-4">
									<form th:action="@{/customer/process-add}" method="post" id="form_cust">
										<div class="row g-4">
											<div class=" col-md-6">
												<label for="customer_name" class=" form-label">Customer name<span
														style="color:red;">*</span></label>
												<input type="text" class="form-control" id="customer_name"
													name="customerName">
												<div class="error-message" id="cp-name-error" style="color: red;"></div>
											</div>
											<div class="col-md-6 ">
												<label class="form-label">Contact person name</label>
												<div class="multi-field">
													<div class="input_and_select">
														<div class="select">
															<select class="selectpicker form-control"
																id="contact_per_name" name="sel[]">
																<option selected="selected">Select one</option>
																<option value="1">Mr.</option>
																<option value="2">Mrs.</option>
															</select>
														</div>
														<input type="text" class="form-control "
															name="customerParentAccount">
													</div>
												</div>
											</div>
											<div class="col-md-6 me-5">
												<label for="multi-mobile" class="form-label">Mobile<span
														style="color:red;">*</span></label>
												<div class="multi-field-wrapper" id="multi_mobile_wrapper_customer">
													<div class="multi-fields">
														<div class="multi-field mb-2">
															<div class="input_and_select">
																<div class="select">
																	<select class="selectpicker form-control"
																		id="multi-mobile-customer"
																		name="contactNumberCategory0">
																		<option selected="selected" value="MOBILE">
																			Mobile
																		</option>
																		<option value="HOME">Home</option>
																		<option value="WORK">Work</option>
																		<option value="OTHER">Other</option>
																	</select>
																</div>
																<input id="customer_mobileID" type="number"
																	class="form-control " name="contactNumber0"
																	oninput="validateMobile()">
															</div>
															<button type="button" class="remove-field "><img
																	th:src="@{/assest/cross.svg}" class="img-icon"
																	alt=""></button>
														</div>
													</div>
													<button type="button" class="add-field"><img
															th:src="@{/assest/plus.svg}" class="img-icon"
															alt=""></button>
												</div>
												<div class="error-message" id="mobile-error" style="color: red;"></div>
											</div>
											<div class="col-md-6">
												<label for="multi-email" class="form-label">Email<span
														style="color:red;">*</span></label>
												<div class="multi-field-wrapper" id="multi_email_wrapper_customer">
													<div class="multi-fields" id="multi-fields_email">
														<div class="multi-field mb-2" id="multi-field_email">
															<div class="input_and_select">
																<div class="select">
																	<select class="selectpicker form-control"
																		id="multi-email-customer" name="emailCategory0">
																		<option value="PERSONAL">Personal</option>
																		<option value="BUSINESS">Business</option>
																		<option value="OTHER">Other</option>
																	</select>
																</div>
																<input id="customer_emailID" type="text"
																	class="form-control multiCustomerMail"
																	name="email0">
															</div>
															<button type="button" class="remove-field "><img
																	src="@{/assest/cross.svg}" class="img-icon"
																	alt=""></button>
														</div>
													</div>
													<button type="button" class="add-field"><img
															th:src="@{/assest/plus.svg}" class="img-icon"
															alt=""></button>
												</div>
												<div class="mt-1 error-message" id="msg" style="color: red;"></div>
											</div>
										</div>
										<div class="row mt-4">
											<div class="col-md-6 ">
												<label for="depart" class="form-label">Department</label>
												<input type="text" class="form-control" id="depart"
													name="primaryContactDepartment">
											</div>
											<div class="col-md-6 col-xl-3">
												<label for="job_tit" class="form-label">Job title</label>
												<input type="text" class="form-control" id="job_tit"
													name="primaryContactJobTitle">
											</div>
										</div>
										<div class="row mt-4">
											<div class="col-md-12">
												<div class="switch-wrapper">
													<label class="switch" for="bill_contact">
														<input type="checkbox" id="bill_contact"
															name="primaryContactIsBillingContact">
														<span class="slider round"></span>
													</label>
													<p class="m-0">Billing contact</p>
												</div>
											</div>
											<div class="col-md-12">
												<div class="switch-wrapper">
													<label class="switch" for="book_contact">
														<input type="checkbox" id="book_contact"
															name="primaryContactIsBookingContact">
														<span class="slider round"></span>
													</label>
													<p class="m-0">Booking contact</p>
												</div>
											</div>
										</div>
										<div
											class="heading_plusbutton justify-content-between d-flex align-items-center mt-5">
											<p class="section-heading">Stored service location</p>
											<button type="button" class="add_loaction mb-3"><img
													src="./assest/plus_circle.png" alt="">Add Location</button>
										</div>
										<div class="location-fields row g-4 position-relative" id="location-fields">
											<div class="col-md-6 ">
												<label for="location_name" class="form-label">Location nickname</label>
												<input type="text" class="form-control" id="location_name"
													name="locationNickName0">
											</div>
											<div class="col-md-6 ">
												<label for="apt_suite" class="form-label">Apt/suite/unit</label>
												<input type="text" class="form-control" id="apt_suite" name="unit0">
											</div>
											<div class="col-md-6 ">
												<label for="loca_address" class="form-label">Address</label>
												<input type="text" class="form-control" id="loca_address"
													name="address0">
											</div>
											<div class="col-md-6 ">
												<label for="locat_city" class="form-label">City</label>
												<input type="text" class="form-control" id="locat_city" name="city0">
											</div>
											<div class="col-md-6">
												<label for="locat_state" class="form-label">State/province</label>
												<input type="text" class="form-control" id="locat_state" name="state0">
											</div>
											<div class="col-md-6 ">
												<label for="locat_zip" class="form-label">Zip</label>
												<input type="text" class="form-control" id="locat_zip" name="zip0">
											</div>
											<div class="row mt-4">
												<div class="col-md-12">
													<div class="switch-wrapper">
														<label class="switch" for="prim_location">
															<input type="checkbox" id="prim_location"
																name="isPrimaryLocation0">
															<span class="slider round"></span>
														</label>
														<p class="m-0">Primary location</p>
													</div>
												</div>
												<div class="col-md-12">
													<div class="switch-wrapper">
														<label class="switch" for="bill_address">
															<input type="checkbox" id="bill_address"
																name="isBillingAddress0">
															<span class="slider round"></span>
														</label>
														<p class="m-0">Billing address</p>
													</div>
												</div>
											</div>
											<button type="button" class="delete-location"><img src="./assest/trash.svg"
													class="img-icon" alt="">Delete</button>
										</div>
										<p class="mt-5 section-heading">Additional information</p>
										<div class="row g-4">
											<div class="col-md-6">
												<label for="ref_source" class="form-label">Referral source</label>
												<input type="text" class="form-control" id="ref_source"
													name="referalSource">
											</div>
											<div class="col-md-6 ">
												<label class="form-label">Industry</label>
												<select class="selectpicker form-control" id="select_indus"
													name="customerIndustry">
													<option selected="selected">Select one</option>
													<option th:each="industry : ${industries}" th:value="${industry}"
														th:text="${industry}"></option>
												</select>
											</div>
											<div class="col-md-6 ">
												<label for="select_currency" class="form-label">Default currency</label>
												<select class="selectpicker form-control" id="select_currency"
													name="currency">
													<option selected="selected">Select one</option>
													<option th:each="currency : ${currencies}" th:value="${currency}"
														th:text="${currency}"></option>
												</select>
											</div>
											<div class="col-md-6 ">
												<label for="businessid" class="form-label">Business number/Tax
													ID</label>
												<input type="text" class="form-control" id="businessid"
													name="buisnessNumber">
											</div>
											<div class="col-md-6">
												<label class="form-label">Assigned salesperson</label> <select
													class="selectpicker form-control" id="select_indus"
													name="salesPersonId" required>
													<option th:each="salesPerson : ${salesPersons}"
														th:value="${salesPerson.salesPersonId}"
														th:text="${salesPerson.salesPersonName}"></option>
												</select>
											</div>
											<div class="col-lg-6">
												<label for="inpexpiry" class="form-label">Internal/Private notes</label>
												<textarea class="form-control custom-area" id="inpexpiry"
													name="privateNotes" rows="3"></textarea>
											</div>
										</div>
										<div class="col-12">
											<div class="form-submit">
												<a class="secondary-btn form-btns me-3" id="addCustomerPopupCloseBtn"
													data-bs-dismiss="modal">Cancel</a>
												<button type="button" onclick="addCustomerPopup()"
													class="primary-btn form-btns">Add
													Customer</button>
											</div>
										</div>
									</form>
								</div>
							</div>

						</div>
					</div>
				</div>
				<!-- add_customer_modal_end -->

				<!-- add_product_modal -->
				<div class="modal fade" id="addProductModal" tabindex="-1" aria-labelledby="addProductLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered modal-lg">
						<button type="button" class="btn-close" id="addProductPopupCloseBtn" data-bs-dismiss="modal"
							aria-label="Close"></button>
						<div class="modal-content update-profile-modal">
							<button type="button" class="btn-close" id="addProductPopupCloseBtn" data-bs-dismiss="modal"
								aria-label="Close"></button>
							<div class="modal-body">
								<div class="est-header d-flex">
									<h5 class="fw-bold">Add Product</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="send-estimate-container mt-4">
									<form class="row g-4" id="form_prodct"
										th:action="@{/product/process-popup-addProduct}" method="post"
										enctype="multipart/form-data">
										<p class="section-heading">Product Information</p>

										<div class="col-md-6">
											<input type="hidden" id="clickedJobTableNumber" />
											<input type="hidden" id="clickedJobTableRowNumber" />
											<div class="input_field">
												<label for="inpproduct" class="form-label">Product
													Name</label> <input type="text" class="form-control" id="inpproduct"
													name="productName"> <i class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6">
											<label for="select_product_cat" class="form-label">Product
												Category</label> <select class="selectpicker form-control"
												id="select_product_cat" name="productCategoryId">
												<option value="" selected="selected">Select one</option>
												<option th:each="productCat : ${productCategories}"
													th:value="${productCat.productCategoryId}"><span
														th:text="${productCat.productCategoryName}"></span>
												</option>
												<!-- <option value="2">2</option>
												<option value="3">3</option>
												<option value="4">4</option> -->

											</select>
										</div>
										<div class="col-md-6">
											<label for="inpwork" class="form-label">Description</label>
											<textarea class="form-control custom-area" id="inpwork" rows="3"
												name="discription"></textarea>
										</div>
										<div class="col-md-6 position-relative">
											<label class="form-label">Product Images</label>
											<div class="upload__box">
												<div class="upload__img-wrap"></div>
												<div class="upload__btn-box">
													<label class="upload__btn primary-btn">Upload
														images <input type="file" data-max_length="20"
															class="upload__inputfile" name="categoryImage"
															id="categoryImage" accept="image/*">
													</label>
												</div>
											</div>
										</div>

										<p class="mt-5 section-heading">Sales & Purchasing
											Details</p>

										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="reg_price" class="form-label">Regular
													Price($)</label> <input type="text" class="form-control"
													id="reg_price" placeholder="0.00" name="regularPrice">
												<i class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="mem_price" class="form-label">Member
													Price($)</label> <input type="text" class="form-control"
													id="mem_price" placeholder="0.00" name="memberPrice"> <i
													class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="avg_cost" class="form-label">Average
													Cost($)</label> <input type="text" class="form-control"
													id="avg_cost" placeholder="0.00" name="averageCost">
												<i class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>

										<div class="col-12">
											<div class="form-submit">
												<!--<a class="secondary-btn form-btns me-3"
													data-bs-dismiss="modal">Cancel</a>-->
												<button type="button" onclick="addProductPopup()"
													class="primary-btn form-btns">Add
													Product</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- add_product_modal end-->

				<!-- add_service_modal-->
				<div class="modal fade" id="addServiceModal" tabindex="-1" aria-labelledby="addServiceLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered modal-lg">
						<button type="button" class="btn-close" id="addServicePopupCloseBtn" data-bs-dismiss="modal"
							aria-label="Close"></button>
						<div class="modal-content update-profile-modal">
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							<div class="modal-body">
								<div class="est-header d-flex">
									<h5 class="fw-bold">Add Service</h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<div class="send-estimate-container mt-4">

									<form method="post" th:action="@{/service/process-popup-addSerivce}"
										enctype="multipart/form-data" class="row g-4" id="form_service">
										<p class="section-heading">Service Information</p>
										<div class="col-md-6">
											<div class="input_field">
												<label for="inp_service_name" class="form-label">Service
													Name</label> <input type="text" class="form-control"
													id="inp_service_name" name="serviceName"> <i
													class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6">
											<label for="select_service_category" class="form-label">Service
												Category</label> <select class="selectpicker form-control"
												id="select_service_category" name="serviceCategoryId">
												<option selected="selected">Select one</option>
												<option th:each="serviceCat : ${serviceCategories}"
													th:value="${serviceCat.serviceCategoryId}"><span
														th:text="${serviceCat.serviceCategoryName}"></span>
												</option>
												<!-- <option value="1">Service 1</option>
                                                            <option value="1">Service 2</option>
                                                            <option value="1">Service 3</option>
                                                            <option value="1">Service 4</option> -->

											</select>
										</div>
										<div class="col-md-6">
											<label for="inp_ser_dec" class="form-label">Description</label>
											<textarea class="form-control custom-area" id="inp_ser_dec" rows="3"
												name="discription"></textarea>
										</div>
										<div class="col-md-6 position-relative">
											<label class="form-label">Service Images</label>
											<div class="upload__box">
												<div class="upload__img-wrap"></div>
												<div class="upload__btn-box">
													<label for="upload_service_pics"
														class="upload__btn primary-btn">Upload
														images <input type="file" multiple="" data-max_length="20"
															class="upload__inputfile" id="upload_service_pics"
															name="categoryImage" accept="image/*">
													</label>
												</div>
											</div>
										</div>

										<p class="mt-5 section-heading">Service Rates</p>

										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="reg_rate" class="form-label">Regular
													Rate($)</label> <input type="text" class="form-control"
													id="reg_rate" name="regularPrice"> <i
													class="fas fa-check-circle"></i>
												<i class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="mem_rate" class="form-label">Member
													Rate($)</label> <input type="text" class="form-control"
													id="mem_rate" name="internalCost"> <i
													class="fas fa-check-circle"></i>
												<i class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>

										<div class="col-12">
											<div class="form-submit">
												<!--<a class="secondary-btn form-btns me-3" id="addServicePopupCloseBtn"
													data-bs-dismiss="modal">Cancel</a>-->
												<button type="button" onclick="addServicePopup()"
													class="primary-btn form-btns">Add
													Service</button>
											</div>
										</div>
									</form>
								</div>
							</div>

						</div>
					</div>
				</div>
				<!-- add_service_modal_end -->

				<!-- Alert Modal -->
				<div class="modal fade" id="alertModal" tabindex="-1" aria-labelledby="alertModalLabel"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered">
						<div class="modal-content">
							<!-- Close button -->
							<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							<!-- Modal Header -->
							<div class="modal-header">
								<h4 class="modal-title" id="deleteConfirmationLabel">Alert
								</h4>
							</div>
							<!-- Modal Body -->
							<div class="modal-body">
								<p>Please select atleast one customer and one product/service from search results.</p>
							</div>

							<!-- Modal Footer -->
							<div class="modal-footer">
								<!-- Cancel Button -->
								<button type="button" class="btn btn-danger" data-bs-dismiss="modal">Okay</button>
							</div>
						</div>
					</div>
				</div>
				<!-- Alert Modal End -->
				<div class="card data-cards">
					<div class="add-satff-container p-2">
						<div class="data-cards-header d-flex justify-content-between estimate-header">
							<h4>Add Job</h4>
						</div>
						<div class="data-cards-body mt-4">
							<p class="section-heading">Genearal Information</p>
							<form class="row g-4" id="estimate-form" th:action="@{/job/process-add}" method="post">
								<div class="col-md-6 position-relative">
									<label for="customer_name" class="form-label">Customer
										name</label>
									<input class="form-control" type="text" name="customerName" id="customer_name_input"
										onKeyUp="searchCustomer(event)" autocomplete="off" value="">
									<div id="customer_search_results" class="search-results"></div>
								</div>
								<ul id="search-customers"></ul>
								<div class="col-md-6 col-xl-3">
									<label class="form-label">Parent Account Name</label>
									<input class="form-control" id="paren_acc" name="customerParentAccount" readonly />
								</div>
								<div class="col-md-6 col-xl-3 me-5">
									<label for="multi-mobile" class="form-label">Mobile</label>
									<div class="multi-field-wrapper" id="multi_mobile_wrapper_estimate">
										<div class="multi-fields">
											<div class="multi-field mb-2">
												<div class="input_and_select">
													<div class="select">
														<select class="selectpicker form-control" id="multi-mobile"
															name="sel[]">
															<option value="MOBILE">Mobile</option>
															<option value="HOME">Home</option>
															<option value="WORK">Work</option>
															<option value="OTHER">Other</option>
														</select>
													</div>
													<input id="estimate_mobileID" type="text" class="form-control"
														name="contactNumber" readonly>
												</div>
												<button type="button" class="remove-field ">
													<img th:src="@{/assest/cross.svg}" class="img-icon" alt="">
												</button>
											</div>
										</div>
									</div>
								</div>
								<div class="col-md-6 col-xl-3">
									<label for="multi-email" class="form-label">Email</label>
									<div class="multi-field-wrapper" id="multi_email_wrapper_estimate">
										<div class="multi-fields" id="multi-fields_email">
											<div class="multi-field mb-2" id="multi-field_email">
												<div class="input_and_select">
													<div class="select">
														<select class="selectpicker form-control"
															id="multi-email-estimate"
															name="estimate_email_multi_select">
															<option selected="selected" value="PERSONAL">Personal
															</option>
															<option value="PERSONAL">Business </option>
															<option selected="OTHER" value="OTHER">Other</option>
														</select>
													</div>
													<input id="estimate_emailID" name="estimate_email_multi" type="text"
														class="form-control" readonly>
												</div>
												<button type="button" class="remove-field ">
													<img th:src="@{/assest/cross.svg}" class="img-icon" alt="">
												</button>
											</div>
										</div>
									</div>
								</div>
								<p class="mt-5 section-heading">Service location</p>
								<div class="col-md-6 col-xl-3">
									<label for="location_name" class="form-label">Location
										nickname</label>
									<input type="text" class="form-control" id="es_location_name"
										name="estimate_email_multi" readonly>
								</div>
								<div class="col-md-6 col-xl-3">
									<label for="apt_suite" class="form-label">Apt/suite/unit</label>
									<input type="text" class="form-control" id="es_apt_suite" readonly>
								</div>
								<div class="col-md-6">
									<label for="loca_address" class="form-label">Address</label>
									<input type="text" class="form-control" id="es_loca_address" readonly>
								</div>
								<div class="col-md-6 col-xl-3">
									<label for="locat_city" class="form-label">City</label>
									<input type="text" class="form-control" id="es_locat_city" readonly>
								</div>
								<div class="col-md-6 col-xl-3">
									<label for="locat_state" class="form-label">State/Zip</label>
									<input type="text" class="form-control" id="es_locat_state" readonly>
								</div>
								<p class="mt-5 section-heading">Additional information</p>
								<div class="col-md-6 col-xl-3">
									<label for="select_tax_item" class="form-label"> Current Status</label>
									<select class="selectpicker form-control" id="select_tax_item" name="jobStatus">
										<option th:each="status : ${jobStatus}" th:value="${status}"
											th:text="${status}">
										</option>
									</select>
								</div>
								<div class="col-md-6 col-xl-3">
									<label for="select_tax_item" class="form-label">Assign
										Sales Person</label> <select class="selectpicker form-control"
										id="select_tax_item" name="salesPerson" required>
										<option th:each="salesPerson : ${salesPersons}"
											th:value="${salesPerson.salesPersonId}"
											th:text="${salesPerson.salesPersonName}"></option>
									</select>
								</div>
								<!--<div class="heading_plusbutton justify-content-end d-flex align-items-center mt-5 __web-inspector-hide-shortcut__"
									style="margin-top: -7%;">
									<p class="section-heading"></p>
									<button id="btn-add-tab" type="button" class="add_estimates"
										style="margin-right: 2rem;">
										<img th:src="@{/assest/plus_circle.png}" alt=""> Add New Option
									</button>
								</div>-->
								<ul class="nav nav-tabs" id="myTab_custom" role="tablist">
									<li class="nav-item" role="presentation">
										<button class="nav-link active " id="tab_label1" data-bs-toggle="tab"
											data-bs-target="#tab1" type="button" role="tab" aria-controls="tab1"
											aria-selected="true">
											<div class="col-md-12 input-items">
												<img th:src="@{/assest/document-signed.svg}" class="img-icon me-2">
												<lable class="estimate-nav-item-label">Job Products/Services</lable>
											</div>
										</button>
									</li>
								</ul>
								<div class="tab-content" id="myTabContent_custom">
									<div class="tab-pane fade show active" id="tab1" role="tabpanel"
										aria-labelledby="tab_label1">
										<div class="estimate_report_container">
											<div class="container-fluid custome-data-table mt-5 p-0 overflow-auto">
												<table id="job-table1" name="job-table1"
													class="table custom-table custom-category-table dt-responsive nowrap w-100">
													<input type="hidden" name="job-table1-input" value=1>
													<thead>
														<tr>
															<th>
															</th>
															<th width="40%">Product/Service</th>
															<th>Description</th>
															<th>Quantity</th>
															<th>Rate</th>
															<th>Total</th>
															<th>Cost</th>
															<th>Action</th>
														</tr>
													</thead>
													<tbody>
														<tr id="job-table1tr1">
															<td>1</td>
															<td>
																<div class="input-with-icon"
																	style="position: relative;">
																	<input type="text" onclick="generateProductRow(1)"
																		placeholder="Type for search product.."
																		class="form-control"
																		name="job-table1ProductName1"
																		id="job-table1ProductName1" value=""
																		onKeyUp="onSearchType(event)"
																		autocomplete="off">
																</div>
																<div class="product_service_suggestions_wrapper"
																	id="productServicSuggestionsWrapper">
																</div>
																<div id="job-table1search_results1"
																	class="search-results">
																</div>
															</td>
															<td>
																<input type="text" class="form-control" placeholder=""
																	id="job-table1Description1"
																	name="job-table1Description1" value="">
															</td>
															<td>
																<input type="number" class="form-control"
																	placeholder="0.00" id="job-table1Quantity1"
																	name="job-table1Quantity1" value="1.0"
																	onchange="calculateTotal($('#'+this.id))" min="1">
															</td>
															<td><input type="text" class="form-control"
																	placeholder="0.00" id="job-table1Rate1"
																	name="job-table1Rate1" value="0" readonly>
															</td>
															<td><input type="text" class="form-control"
																	placeholder="0.00" id="job-table1Total1"
																	name="job-table1Total1" value="0" readonly>
															</td>
															<td><input type="text" class="form-control"
																	placeholder="1480.00" value="0"
																	name="job-table1AverageCost1"
																	id="job-table1AverageCost1" readonly>
																<input type="hidden" value="0"
																	name="job-table1AverageCost1"
																	id="job-table1AverageCostIntial1">
															</td>
															<td>
																<span>
																	<button type="button" disabled id="delBtn"
																		class="table-action-buttons del-btn del-row">
																		<img th:src="@{/assest/trash.svg}"
																			class="img-fluid plan-carousel-btn"
																			alt="icon">
																	</button>
																</span>
															</td>
														</tr>
														<ul id="search-results"></ul>
													</tbody>
												</table>
											</div>
											<div class="job_summary_container mt-5">
												<div class="row">
													<div class="col-lg-6 mb-3 mb-lg-0">
														<label for="inpexpiry" class="form-label">Notes to
															Customer</label>
														<textarea class="form-control custom-area" id="inpexpiry"
															rows="3"></textarea>
													</div>
													<div class="col-lg-6">
														<div class="job_summary">
															<div class="order-summary ">
																<h4 class="text-end fs-5">Job Summary</h4>
																<hr>
																<div class="plan">
																	<p>Job Total :</p>
																	<input type="hidden" id="job-table1JobTotal"
																		name="job-table1JobTotal" />
																	<h5 id="job-table1JobTotalTxt">$00.00
																	</h5>
																</div>
																<div class="plan">
																	<p>Job Cost :</p>
																	<input type="hidden" id="job-table1JobCost"
																		name="job-table1JobCost" />
																	<h5 id="job-table1JobCostTxt">$0.00</h5>
																</div>
																<div class="plan">
																	<p>
																		Gross Profit :
																	</p>
																	<input type="hidden" id="job-table1GrossProfit"
																		name="job-table1GrossProfit" />
																	<h5 id="job-table1GrossProfitTxt">$00.00
																	</h5>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-12">
									<div class="form-submit">
										<a th:href="@{/job/jobs}" class="secondary-btn form-btns me-3"
											id="mainPageCancel">Cancel</a>
										<button type="button" onclick="saveAndSendEstimate()"
											class="primary-btn form-btns me-3 saveAndSendBtn" id="addEstimateBtn">Save &
											Send
											Job</button>
										<button type="submit" class="primary-btn form-btns" id="addEstimateBtn">Save
											Job</button>
									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/js/jquery.min.js}"></script>
	<script th:src="@{/js/bootstrap-select.min.js}"></script>
	<script th:src="@{/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/js/dataTables.responsive.min.js}"></script>
	<script th:src="@{/js/responsive.bootstrap5.min.js}"></script>
	<script th:src="@{/js/dataTables.bootstrap5.min.js}"></script>
	<script th:src="@{/js/slimselect.js}"></script>
	<script th:src="@{/js/customNewTab.js}"></script>
	<script th:src="@{/js/job.js}"></script>

	<!-- -----Leave page validation----- -->
	<script>
		$(document).ready(function () {

			disableSaveAndSendBtn();

			var originalURL = "";
			$('a').on('click', function (e) {
				if (!window.location.href.includes('/view/') && !event.target.id.includes('mainPageCancel')) {
					var elementType = this.tagName.toLowerCase();
					var isInsideMainDiv = $(this).closest('#add-job-parent-div').length > 0;

					if (elementType === "a" && !isInsideMainDiv) {
						originalURL = $(this).attr('href'); // Get the URL of the clicked link
					}

					if ($('#customer_name_input').val() || $('#estimate-table1ProductName1').val()) {
						// Open the modal and prevent the link or button from being followed
						$('#leaveModal').modal('show');
						e.preventDefault();
					}
				}
			});

			// When Leave button in the modal is clicked, redirect to the original link URL
			$('#leaveButton').on('click', function () {
				if (originalURL !== "") {
					window.location.href = originalURL;
				} else {
					// Handle the case when the Leave button is clicked without a previous link
					console.log("Redirect URL not available.");
				}
			});

			// When Cancel button in the modal is clicked, dismiss the modal
			$('#cancelButton').on('click', function () {
				$('#leaveModal').modal('hide');
			});

			// When the modal is hidden, reset the original URL
			$('#leaveModal').on('hide.bs.modal', function () {
				originalURL = "";
			});

			// Listen for browser back button click
			$(window).on('popstate', function () {
				// If the modal is currently open, close it
				if ($('#leaveModal').hasClass('show')) {
					$('#leaveModal').modal('hide');
				}
			});
		});

		//--------Add Customer Pop-up Validation---------//
		$("#customer_emailID").on("keyup", function (e) {
			var email = $('#customer_emailID').val();
			if ($('#customer_emailID').val() == null || $('#customer_emailID').val() == "") {
				$('#msg').show();
				$("#msg").html("email is a required field.").css("color", "red");
			} else {
				var regex =
					/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
				if (!regex.test(email)) {
					$('#msg').show();
					$("#msg").html("Invalid Email").css("color", "red");
					return;
				}
				$.ajax({
					type: 'GET',
					url: '/customer/searchByEmail/' + email,
					cache: false,
					success: function (msg) {
						$('#msg').show();
						$.each(msg, function (index, value) {
							console.log(value)
							console.log(index)
							if (value === 'Email already exists') {
								$("#msg").html(value).css("color", "red");
							} else {
								$("#msg").html(value).css("color", "green");
							}
						});


					},
					error: function (jqXHR, textStatus, errorThrown) {
						alert("fail");
						$('#msg').show();
						$("#msg").html(textStatus + " " + errorThrown).css("color", "red");
					}
				});
			}
		});

	</script>
	<script>
		var tables = document.getElementsByTagName('table');
		for (var i = 0; i < tables.length; i++) {
			resizableGrid(tables[i]);
		}

		function resizableGrid(table) {
			var row = table.getElementsByTagName('tr')[0],
				cols = row ? row.children : undefined;
			if (!cols) return;

			table.style.overflow = 'hidden';

			var tableHeight = table.offsetHeight;

			for (var i = 0; i < cols.length; i++) {
				var div = createDiv(tableHeight);
				cols[i].appendChild(div);
				cols[i].style.position = 'relative';
				setListeners(div);
			}

			function setListeners(div) {
				var pageX, curCol, nxtCol, curColWidth, nxtColWidth;

				div.addEventListener('mousedown', function (e) {
					curCol = e.target.parentElement;
					nxtCol = curCol.nextElementSibling;
					pageX = e.pageX;

					var padding = paddingDiff(curCol);

					curColWidth = curCol.offsetWidth - padding;
					if (nxtCol)
						nxtColWidth = nxtCol.offsetWidth - padding;
				});

				div.addEventListener('mouseover', function (e) {
					e.target.style.borderRight = '2px solid #0000ff';
				})

				div.addEventListener('mouseout', function (e) {
					e.target.style.borderRight = '';
				})

				document.addEventListener('mousemove', function (e) {
					if (curCol) {
						var diffX = e.pageX - pageX;

						if (nxtCol)
							nxtCol.style.width = (nxtColWidth - (diffX)) + 'px';

						curCol.style.width = (curColWidth + diffX) + 'px';
					}
				});

				document.addEventListener('mouseup', function (e) {
					curCol = undefined;
					nxtCol = undefined;
					pageX = undefined;
					nxtColWidth = undefined;
					curColWidth = undefined;
				});
			}

			function createDiv(height) {
				var div = document.createElement('div');
				div.style.top = 0;
				div.style.right = 0;
				div.style.width = '5px';
				div.style.position = 'absolute';
				div.style.cursor = 'col-resize';
				div.style.userSelect = 'none';
				div.style.height = height + 'px';
				return div;
			}

			function paddingDiff(col) {

				if (getStyleVal(col, 'box-sizing') == 'border-box') {
					return 0;
				}

				var padLeft = getStyleVal(col, 'padding-left');
				var padRight = getStyleVal(col, 'padding-right');
				return (parseInt(padLeft) + parseInt(padRight));

			}

			function getStyleVal(elm, css) {
				return (window.getComputedStyle(elm, null).getPropertyValue(css))
			}
		};
	</script>


</body>

</html>