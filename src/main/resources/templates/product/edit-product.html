<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/dataTables.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/slimselect.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-icons.min.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-select.min.css}">
	<link rel="stylesheet" th:href="@{/css/style.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.css}">
	<link rel="stylesheet" th:href="@{/css/addproduct-cdn.css}">
</head>

<body>
	<!--navbar-->

	<div class="body_container d-flex">
		<div th:replace="component/sidebar :: sidebar"></div>
		<div class="main">
			<!-- haeder -->
			<header th:replace="component/topmenu :: topmenu"></header>
			<!-- headerend -->
			<!-- mainconatiner -->
			<div class="container-fluid p-2 p-md-3 p-lg-4 scroll-conatiner">
				<div class="row h-100">
					<div class="col-12">
						<div class="card data-cards h-100">
							<div class="add-satff-container p-2">
								<div class="data-cards-header">
									<h4>Edit Product</h4>
								</div>
								<div class="data-cards-body mt-4">

									<form class="row g-4" id="form_prodct" th:action="@{/product/process-update}"
										method="post" enctype="multipart/form-data" onsubmit="formatPrices()">
										<p class="section-heading">Product Information</p>
										<input type="hidden" name="productId" th:value="${productDto.productId}">
										<div class="col-md-6">
											<div class="input_field">
												<label for="inpproduct" class="form-label">Product
													Name</label> <input type="text" class="form-control" id="inpproduct"
													name="productName" th:value="${productDto.productName}"> <i
													class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6">
											<label for="select_product_cat" class="form-label">Product
												Category</label> <select class="selectpicker form-control"
												id="select_product_cat" name="productCategoryId"
												th:value="${productDto.productCategoryId}">
												<option value="" selected="selected">Select one</option>
												<option th:each="productCat : ${productCategories}"
													th:value="${productCat.productCategoryId}"
													th:selected="${productDto.productCategoryId == productCat.productCategoryId}">
													<span th:text="${productCat.productCategoryName}"></span>
												</option>
												<!-- <option value="2">2</option>
												<option value="3">3</option>
												<option value="4">4</option> -->

											</select>
										</div>
										<div class="col-md-6">
											<label for="inpwork" class="form-label">Description</label>
											<textarea class="form-control custom-area" id="inpwork" rows="3"
												name="discription" th:text="${productDto.discription}"></textarea>
										</div>
										<div class="col-md-6 position-relative">
											<label class="form-label">Product Images</label>
											<div class="upload__box">
												<div class="upload__img-wrap"></div>
												<div class="upload__btn-box">
													<label class="upload__btn primary-btn">Upload
														images <input type="file" multiple="" data-max_length="20"
															class="upload__inputfile" name="categoryImage"
															accept="image/*">
													</label>
												</div>
											</div>
										</div>

										<p class="mt-5 section-heading">Sales & Purchasing Details</p>

										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="reg_price" class="form-label">Regular
													Price($)</label> <input type="text" class="form-control"
													id="reg_price" placeholder="0.00" name="regularPrice"
													th:value="'$'+${#numbers.formatDecimal(productDto.regularPrice, 0, 'COMMA', 2, 'POINT')}"
													step="0.01" oninput="updateHiddenField(this, 'reg_price')">
												<i class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="mem_price" class="form-label">Member
													Price($)</label> <input type="text" class="form-control"
													id="mem_price" placeholder="0.00" name="memberPrice"
													th:value="'$'+${#numbers.formatDecimal(productDto.memberPrice, 0, 'COMMA', 2, 'POINT')}"
													step="0.01" oninput="updateHiddenField(this, 'mem_price')"> <i
													class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>
										<div class="col-md-6 col-xl-3">
											<div class="input_field">
												<label for="avg_cost" class="form-label">Average
													Cost($)</label> <input type="text" class="form-control"
													id="avg_cost" placeholder="0.00" name="averageCost"
													th:value="'$'+${#numbers.formatDecimal(productDto.averageCost, 0, 'COMMA', 2, 'POINT')}"
													step="0.01" oninput="updateHiddenField(this, 'avg_cost')">
												<i class="fas fa-check-circle"></i> <i
													class="fas fa-exclamation-circle"></i> <small>Error
													message</small>
											</div>
										</div>

										<div class="col-12">
											<div class="form-submit">
												<a th:href="@{/product/products}" class="secondary-btn form-btns me-3"
													id="mainPageCancel">Cancel</a>
												<button type="submit" class="primary-btn form-btns">Update
													Product</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/js/jquery.min.js}"></script>
	<script th:src="@{/js/bootstrap-select.min.js}"></script>
	<script th:src="@{/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/js/dataTables.responsive.min.js}"></script>
	<script th:src="@{/js/responsive.bootstrap5.min.js}"></script>
	<script th:src="@{/js/dataTables.bootstrap5.min.js}"></script>
	<script th:src="@{/js/slimselect.js}"></script>
	<script th:src="@{/js/addproduct-js.js}"></script>
	<script th:src="@{/js/main.js}"></script>
	<!-- <script th:src="@{/js/form_validations.js}"></script> -->
	<script>
		function updateHiddenField(input, hiddenFieldId) {
			let value = input.value.replace(/[^0-9.]/g, '');
			document.getElementById(hiddenFieldId).value = value;
			value = input.value.replace(/[^0-9.]/g, '');
			value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			value = "$" + value;
			input.value = value;
		}
	</script>
	<script>
		function formatPrices() {

			let avgCostStr = document.getElementById("avg_cost");
			let mem_privceStr = document.getElementById("mem_price");
			let regPriceStr = document.getElementById("reg_price");
			avgCostStr.value = avgCostStr.value.replace(/[$,]/g, '');
			mem_privceStr.value = mem_privceStr.value.replace(/[$,]/g, '');
			regPriceStr.value = regPriceStr.value.replace(/[$,]/g, '');
			alert(originalPriceStr);
			return false;

		}
	</script>

</body>

</html>