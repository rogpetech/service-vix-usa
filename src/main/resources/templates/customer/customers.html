<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" th:href="@{/css/dataTables.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.bootstrap5.min.css}">
	<link rel="stylesheet" th:href="@{/css/slimselect.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/css/bootstrap-icons.min.css}">
	<link rel="stylesheet" th:href="@{/css/style.css}">
	<link rel="stylesheet" th:href="@{/css/responsive.css}">
	<link rel="stylesheet" th:href="@{/https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css}">
</head>

<body>
	<!--navbar-->

	<div class="body_container d-flex">
		<div th:replace="component/sidebar :: sidebar"></div>
		<div class="main">
			<!-- haeder -->
			<header th:replace="component/topmenu :: topmenu"></header>
			<!-- headerend -->
			<!-- mainconatiner -->
			<div class="container-fluid p-2 p-md-3 p-lg-4 scroll-conatiner">
				<div class="card data-cards ">
					<div class="workforce-container">
						<nav>
							<div class="nav nav-tabs" id="nav-tab" role="tablist">
								<button class="nav-link active custom-navlink" id="nav-workforce-tab"
									data-bs-toggle="tab" data-bs-target="#nav-workforce" type="button" role="tab"
									aria-controls="nav-workforce" aria-selected="true">
									Customer List</button>
								<!-- <button class="nav-link custom-navlink" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Profile</button>
                                      <button class="nav-link custom-navlink" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-contact" type="button" role="tab" aria-controls="nav-contact" aria-selected="false">Contact</button> -->
							</div>
						</nav>
						<div class="mt-2" th:if="${session.message}">
							<div class="alert alert-success alert-dismissible "
								th:classappend="${session.message.type == 'success'} ? 'alert-success ' : 'alert-danger '"
								role="alert">
								<div th:if="${session.message.type == 'success'}">
									<strong><i class="bi bi-check-circle-fill me-2"></i>Hey! </strong><span
										th:text="${session.message.text}"></span>
								</div>
								<div th:unless="${session.message.type == 'success'}">
									<strong><i class="bi bi-x-circle-fill me-2"></i></i>Oops ! </strong><span
										th:text="${session.message.text}"></span>
								</div>
								<button type="button" class="btn-close" data-bs-dismiss="alert"
									aria-label="Close"></button>
							</div>
						</div>
						<div class="tab-content" id="nav-tabContent">
							<div class="tab-pane fade show active" id="nav-workforce" role="tabpanel"
								aria-labelledby="nav-workforce-tab">
								<div class="container-fluid custome-data-table mt-5">
									<table id="customer_list-table"
										class="table mt-3 custom-table custom-list-table dt-responsive nowrap">
										<a sec:authorize="hasAuthority('CUSTOMER_ADD')" class="primary-btn"
											href="/customer/add" style="float: right;width: auto;">+ Add Customer</a>
										<thead>
											<tr>
												<th><input type="checkbox"></th>
												<th>Customer Name</th>
												<!--<th>Primary Contact</th>-->
												<th>Email</th>
												<th>Phone</th>
												<th>Service Location</th>
												<th>City</th>
												<th>Estimates/Jobs</th>
												<!--<th>Last Service</th>-->
												<th>Actions</th>
											</tr>
										</thead>
										<tbody>
											<tr sec:authorize="hasAuthority('CUSTOMER_LIST_VIEW')"
												th:each="customer, iteration : ${customers}">
												<td><input type="checkbox"></td>
												<td th:text="${customer.customerName}"></td>
												<!--<td th:text="${customer.primaryContactFirstName}"></td>-->
												<td><span
														th:if="${customer.emails != null && #lists.size(customer.emails) > 0}"
														th:text="${customer.emails[0].email}"></span>
													<span
														th:unless="${customer.emails != null && #lists.size(customer.emails) > 0}">No
														Data</span>
												</td>
												<td><span th:if="${#lists.size(customer.contactNumbers) > 0}"
														th:text="${customer.contactNumbers[0].number}"></span>
													<span th:unless="${#lists.size(customer.contactNumbers) > 0}">No
														Data</span>
												</td>
												<td><span th:if="${#lists.size(customer.storedServiceLocations) > 0}"
														th:text="${customer.storedServiceLocations[0].locationNickName}"></span>
													<span
														th:unless="${#lists.size(customer.storedServiceLocations) > 0}">No
														Data</span>
												</td>
												<td><span th:if="${#lists.size(customer.storedServiceLocations) > 0}"
														th:text="${customer.storedServiceLocations[0].city}"></span>
													<span
														th:unless="${#lists.size(customer.storedServiceLocations) > 0}">No
														Data</span>
												</td>
												<td><span class="status-capsule"><span class="estimates-done"> 4</span>
														/ +1</span></td>
												<!--<td>04/04/2023</td>-->
												<td>
													<a sec:authorize="hasAuthority('CUSTOMER_UPDATE')"
														th:href="@{'/customer/update/' + ${customer.customerId}}"><span>
															<button class="table-action-buttons me-2">
																<img th:src="@{/assest/pencil.svg}"
																	class="img-fluid edit-icon" alt="icon">
															</button>
														</span>
													</a>
													<span>
														<button sec:authorize="hasAuthority('CUSTOMER_DELETE')"
															class="table-action-buttons del-btn" type="button"
															data-bs-toggle="modal"
															th:data-bs-target="'#deleteConfirmationModal-' + ${iteration.index}">
															<img th:src="@{/assest/trash.svg}"
																class="img-fluid plan-carousel-btn" alt="">
														</button>
														<!-- Delete Confirmation Modal -->
														<div class="modal fade"
															th:id="'deleteConfirmationModal-' + ${iteration.index}"
															tabindex="-1" aria-labelledby="deleteConfirmationLabel"
															aria-hidden="true">
															<div class="modal-dialog modal-dialog-centered">
																<div class="modal-content">
																	<!-- Close button -->
																	<button type="button" class="btn-close"
																		data-bs-dismiss="modal"
																		aria-label="Close"></button>

																	<!-- Modal Body -->
																	<div class="modal-body">
																		<h4 class="modal-title"
																			id="deleteConfirmationLabel">Delete Customer
																		</h4>
																		<p>Are you sure you want to delete this Customer
																			?</p>
																	</div>

																	<!-- Modal Footer -->
																	<div class="modal-footer">
																		<!-- Cancel Button -->
																		<button type="button" class="btn btn-secondary"
																			data-bs-dismiss="modal">Cancel</button>
																		<!-- Delete Button (You can replace '#' with the URL/endpoint to handle the delete operation) -->
																		<a th:href="@{'/customer/delete/' + ${customer.customerId}}"
																			class="btn btn-danger">Delete</a>
																	</div>
																</div>
															</div>
														</div> <!-- Delete Confirmation Moda End -->
													</span>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>

						</div>
					</div>
				</div>

			</div>
		</div>
	</div>

	<script th:src="@{/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/js/jquery.min.js}"></script>
	<script th:src="@{/js/jquery.dataTables.min.js}"></script>
	<script th:src="@{/js/dataTables.responsive.min.js}"></script>
	<script th:src="@{/js/responsive.bootstrap5.min.js}"></script>
	<script th:src="@{/js/dataTables.bootstrap5.min.js}"></script>
	<script th:src="@{/js/initializeDataTables.js}"></script>
	<script th:src="@{/js/main.js}"></script>
</body>

</html>